Public Sub isLocationFromMockProvider(location1 As Location) As Boolean
    return nativeMe.RunMethod("isLocationFromMockProvider", Array(GetContext, location1))
End Sub

#Region Subs fÃ¼r Mocklocation
#If JAVA
import android.provider.Settings;
import android.provider.Settings.Secure;
import android.content.Context;
import android.test.mock.MockContext;
import android.location.Location;

public static boolean isLocationFromMockProvider(Context context, Location location) {
    boolean isMock = false;
    if (android.os.Build.VERSION.SDK_INT >= 23) {
        isMock = location.isFromMockProvider();
        return isMock;
    } else {
        if (Settings.Secure.getString(context.getContentResolver(), Settings.Secure.ALLOW_MOCK_LOCATION).equals("0"))
            return false;
        else {
            return true;
        }
    } 
}
#End If

Private Sub GetContext As JavaObject
    Return GetBA.GetField("context")
End Sub

Private Sub GetBA As JavaObject
    Dim jo As JavaObject
    Dim cls As String = Me
    cls = cls.SubString("class ".Length)
    jo.InitializeStatic(cls)
    Return jo.GetFieldJO("processBA")
End Sub
